
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Scale Riemann Hypothesis Tester</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
        }
        
        .container {
            background: rgba(30, 30, 45, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            text-align: center;
            color: #a0a0a0;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: rgba(40, 40, 60, 0.8);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .control-group h3 {
            margin: 0 0 15px 0;
            color: #4ecdc4;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #c0c0c0;
        }
        
        input, select, button {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.1);
        }
        
        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .preset-btn {
            padding: 8px 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            margin-top: 0;
        }

        .preset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .results {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .results h3 {
            margin-top: 0;
            color: #4ecdc4;
            border-bottom: 2px solid #4ecdc4;
            padding-bottom: 10px;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            font-weight: 500;
            color: #c0c0c0;
        }
        
        .metric-value {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #4ecdc4;
        }
        
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .math-formula {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #4ecdc4;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            font-family: 'Times New Roman', serif;
            font-size: 1.2em;
        }
        
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: 500;
        }
        
        .status.computing {
            background: rgba(255, 243, 205, 0.2);
            color: #feca57;
            border: 1px solid #feca57;
        }
        
        .status.complete {
            background: rgba(209, 236, 241, 0.2);
            color: #4ecdc4;
            border: 1px solid #4ecdc4;
        }

        .cosmic-status {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border: 2px solid;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .status-cosmic {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.2), rgba(238, 90, 82, 0.2));
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        .status-legendary {
            background: linear-gradient(45deg, rgba(255, 154, 86, 0.2), rgba(255, 123, 123, 0.2));
            border-color: #ff9a56;
            color: #ff9a56;
        }

        .status-mythical {
            background: linear-gradient(45deg, rgba(78, 205, 196, 0.2), rgba(68, 160, 141, 0.2));
            border-color: #4ecdc4;
            color: #4ecdc4;
        }

        .status-excellent {
            background: linear-gradient(45deg, rgba(150, 206, 180, 0.2), rgba(68, 160, 141, 0.2));
            border-color: #96ceb4;
            color: #96ceb4;
        }

        .status-good {
            background: linear-gradient(45deg, rgba(254, 202, 87, 0.2), rgba(255, 159, 67, 0.2));
            border-color: #feca57;
            color: #feca57;
        }

        .status-high {
            background: linear-gradient(45deg, rgba(255, 154, 86, 0.2), rgba(255, 107, 107, 0.2));
            border-color: #ff9a56;
            color: #ff9a56;
        }
        
        .visualization {
            margin-top: 30px;
            text-align: center;
        }
        
        canvas {
            border: 2px solid #4ecdc4;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .theory-box {
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.1), rgba(68, 160, 141, 0.1));
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #4ecdc4;
            border: 1px solid rgba(78, 205, 196, 0.3);
        }
        
        .theory-box h4 {
            margin-top: 0;
            color: #4ecdc4;
        }

        .detailed-results {
            margin-top: 20px;
            background: rgba(20, 20, 30, 0.9);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .top-results-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        .top-results-table th,
        .top-results-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
        }

        .top-results-table th {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
        }

        .insights {
            background: rgba(78, 205, 196, 0.1);
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #4ecdc4;
        }
        
        @keyframes computing {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .computing button {
            animation: computing 2s infinite;
        }

        small {
            color: #a0a0a0;
            font-size: 12px;
            display: block;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåå Cosmic Scale Riemann Hypothesis Tester</h1>
        <p class="subtitle">Browser-Based Computational Testing via M√∂bius Exponential Sums - Up to 100 Million Points</p>
        
        <div class="theory-box">
            <h4>The Riemann Hypothesis - One of Mathematics' Greatest Mysteries</h4>
            <p>The Riemann Hypothesis, proposed by Bernhard Riemann in 1859, is one of the most important unsolved problems in mathematics. It concerns the distribution of prime numbers and has profound implications for number theory, cryptography, and our understanding of mathematical patterns.</p>
            
            <div class="math-formula">
                S(N,Œ±) = Œ£<sub>n‚â§N</sub> Œº(n) ¬∑ e<sup>2œÄinŒ±</sup>
            </div>
            
            <p><strong>What we're testing:</strong> Under the Riemann Hypothesis, these M√∂bius exponential sums should satisfy |S(N,Œ±)| = O(‚àöN) uniformly in Œ±. If we find ratios significantly larger than ‚àöN, it could indicate interesting mathematical phenomena or even contradict RH predictions.</p>
            
            <h4>The M√∂bius Function Œº(n)</h4>
            <p>The M√∂bius function is defined as:</p>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li><strong>Œº(n) = 1</strong> if n is a square-free positive integer with an even number of prime factors</li>
                <li><strong>Œº(n) = -1</strong> if n is a square-free positive integer with an odd number of prime factors</li>
                <li><strong>Œº(n) = 0</strong> if n has a squared prime factor</li>
            </ul>
            <p>Examples: Œº(1)=1, Œº(2)=-1, Œº(3)=-1, Œº(4)=0, Œº(6)=1, Œº(12)=0</p>
        </div>
        
        <div class="theory-box">
            <h4>Historical Context & Significance</h4>
            <p><strong>Clay Millennium Prize:</strong> The Riemann Hypothesis is one of seven Millennium Prize Problems, each worth $1,000,000. It's been verified for the first 10<sup>13</sup> zeros, but a general proof remains elusive.</p>
            
            <p><strong>Prime Number Connection:</strong> The hypothesis directly relates to how accurately we can predict the distribution of prime numbers. If true, it provides the best possible bounds for counting primes.</p>
            
            <p><strong>Cryptographic Implications:</strong> Many modern encryption systems rely on the difficulty of factoring large numbers. RH predictions help us understand the security foundations of these systems.</p>
        </div>
        
        <div class="theory-box">
            <h4>Contributors & References</h4>
            <p><strong>Added by:</strong> Wessen Getachew (<a href="https://twitter.com/7dview" target="_blank" style="color: #4ecdc4;">@7dview</a>)</p>
            <p><strong>Mathematical Framework:</strong> Based on classical work by Davenport, Halberstam, Montgomery, and modern computational number theory</p>
            <p><strong>Implementation:</strong> Optimized JavaScript algorithms for browser-based scientific computing</p>
            <p><strong>Special thanks to:</strong> The open mathematics community, Andrew Odlyzko's computational work, Xavier Gourdon's large-scale verifications, and all researchers who have contributed to our understanding of the Riemann Hypothesis</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <h3>üéØ Test Configuration</h3>
                
                <label for="maxN">Maximum N:</label>
                <div class="preset-buttons">
                    <button class="preset-btn" onclick="setPreset(1000000)">1M</button>
                    <button class="preset-btn" onclick="setPreset(5000000)">5M</button>
                    <button class="preset-btn" onclick="setPreset(10000000)">10M</button>
                    <button class="preset-btn" onclick="setPreset(25000000)">25M</button>
                    <button class="preset-btn" onclick="setPreset(50000000)">50M</button>
                    <button class="preset-btn" onclick="setPreset(100000000)">100M</button>
                </div>
                <input type="number" id="customN" value="1000000" min="1" max="100000000" placeholder="Enter custom N value">
                <small>
                    Performance guide: <br>
                    ‚Ä¢ N < 10,000: Instant<br>
                    ‚Ä¢ N < 100,000: ~1-2 seconds<br>
                    ‚Ä¢ N < 1,000,000: ~5-15 seconds<br>
                    ‚Ä¢ N > 10,000,000: 30+ seconds
                </small>
                
                <label for="testMode">Test Mode:</label>
                <select id="testMode">
                    <option value="stochastic">Stochastic Œ± sampling</option>
                    <option value="major-arcs" selected>Major arcs analysis</option>
                    <option value="uniform">Uniform grid</option>
                    <option value="comprehensive">Comprehensive (all methods)</option>
                </select>
            </div>
            
            <div class="control-group">
                <h3>‚öôÔ∏è Advanced Options</h3>
                <label for="numSamples">Number of Œ± samples:</label>
                <input type="number" id="numSamples" value="100" min="10" max="1000">
                <small>More samples = better coverage but slower computation</small>
                
                <label for="maxDenom">Max denominator (major arcs):</label>
                <input type="number" id="maxDenom" value="12" min="2" max="50">
                <small>Higher values test more rational Œ± = a/q</small>
                
                <label for="showDetails">Show detailed analysis:</label>
                <input type="checkbox" id="showDetails" checked style="width: auto; margin-top: 10px;">
                <small>Display top Œ± values and mathematical insights</small>
                
                <button id="startTest">üöÄ Launch Cosmic Test</button>
            </div>
        </div>
        
        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="statusText" class="status computing">Initializing computation...</div>
        </div>
        
        <div class="results" id="results" style="display: none;">
            <h3>üìä Cosmic Verification Results</h3>
            <div class="metric">
                <span class="metric-label">Maximum N tested:</span>
                <span class="metric-value" id="resultN">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">‚àöN (theoretical bound):</span>
                <span class="metric-value" id="resultSqrtN">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">Maximum |S(N,Œ±)| found:</span>
                <span class="metric-value" id="resultMaxSum">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">Ratio |S(N,Œ±)|/‚àöN:</span>
                <span class="metric-value" id="resultRatio">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">Best Œ± value:</span>
                <span class="metric-value" id="resultBestAlpha">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">Computation time:</span>
                <span class="metric-value" id="computeTime">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">Operations per second:</span>
                <span class="metric-value" id="opsPerSec">-</span>
            </div>

            <div class="cosmic-status" id="cosmicStatus" style="display: none;">
                üåü Status will appear here
            </div>
            
            <div id="detailedResults" style="display: none;" class="detailed-results">
                <h4 style="color: #4ecdc4; margin-bottom: 15px;">Exponential Sum Analysis</h4>
                
                <div style="margin-bottom: 15px;">
                    <label for="resultsView" style="color: #c0c0c0; margin-right: 10px;">View:</label>
                    <select id="resultsView" style="width: auto; display: inline-block; padding: 8px;">
                        <option value="top10">Top 10 Values</option>
                        <option value="top20">Top 20 Values</option>
                        <option value="top50">Top 50 Values</option>
                        <option value="all">All Values</option>
                        <option value="rational">Rational Œ± Only</option>
                        <option value="above-sqrt">Above ‚àöN Only</option>
                    </select>
                    <span id="resultsCount" style="color: #a0a0a0; margin-left: 10px; font-size: 12px;"></span>
                </div>
                
                <div style="max-height: 400px; overflow-y: auto; border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px;">
                    <table class="top-results-table" id="topResultsTable" style="margin-bottom: 0;">
                        <thead style="position: sticky; top: 0; background: rgba(30, 30, 45, 0.95);">
                            <tr>
                                <th>Rank</th>
                                <th>Œ± value</th>
                                <th>|S(N,Œ±)|</th>
                                <th>Ratio</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody id="topResults">
                        </tbody>
                    </table>
                </div>
                
                <div class="insights">
                    <h5 style="color: #4ecdc4; margin-bottom: 10px;">Mathematical Insights</h5>
                    <div id="insights">
                        <p>Complete a test to see detailed analysis and insights.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="visualization" id="visualization" style="display: none;">
            <h3 style="color: #4ecdc4; margin-bottom: 15px;">üìà Advanced Interactive Visualizations</h3>
            
            <!-- Visualization Controls -->
            <div style="background: rgba(40, 40, 60, 0.8); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.1);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="color: #c0c0c0; margin-bottom: 5px; display: block;">Chart Type:</label>
                        <select id="chartType" style="width: 100%; padding: 8px;">
                            <option value="scatter">Scatter Plot</option>
                            <option value="histogram">Histogram</option>
                            <option value="ratio-distribution">Ratio Distribution</option>
                            <option value="alpha-vs-sum">Œ± vs |S(N,Œ±)|</option>
                            <option value="3d-surface">3D Surface Plot</option>
                            <option value="heatmap">Alpha Heatmap</option>
                            <option value="polar">Polar Coordinates</option>
                            <option value="complex-plane">Complex Plane</option>
                        </select>
                    </div>
                    <div>
                        <label style="color: #c0c0c0; margin-bottom: 5px; display: block;">Data Filter:</label>
                        <select id="dataFilter" style="width: 100%; padding: 8px;">
                            <option value="all">All Values</option>
                            <option value="top100">Top 100</option>
                            <option value="top50">Top 50</option>
                            <option value="rational">Rational Œ± Only</option>
                            <option value="above-sqrt">Above ‚àöN</option>
                            <option value="below-sqrt">Below ‚àöN</option>
                            <option value="major-arcs">Major Arcs (q ‚â§ 12)</option>
                        </select>
                    </div>
                    <div>
                        <label style="color: #c0c0c0; margin-bottom: 5px; display: block;">Y-Scale:</label>
                        <select id="yScale" style="width: 100%; padding: 8px;">
                            <option value="linear">Linear</option>
                            <option value="log">Logarithmic</option>
                            <option value="sqrt">Square Root</option>
                        </select>
                    </div>
                    <div>
                        <label style="color: #c0c0c0; margin-bottom: 5px; display: block;">Animation:</label>
                        <input type="checkbox" id="animateChart" style="width: auto; margin-top: 8px;">
                        <label for="animateChart" style="color: #c0c0c0; margin-left: 5px;">Enable</label>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="updateVisualization()" style="background: linear-gradient(45deg, #4ecdc4, #44a08d); padding: 10px 20px; border: none; border-radius: 8px; color: white; cursor: pointer;">Update Chart</button>
                    <button onclick="saveVisualization()" style="background: linear-gradient(45deg, #667eea, #764ba2); padding: 10px 20px; border: none; border-radius: 8px; color: white; cursor: pointer;">Save Image</button>
                    <button onclick="toggleFullscreen()" style="background: linear-gradient(45deg, #ff9a56, #ff7b7b); padding: 10px 20px; border: none; border-radius: 8px; color: white; cursor: pointer;">Fullscreen</button>
                </div>
            </div>
            
            <!-- Multi-Chart Dashboard -->
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px;">
                <!-- Main Chart -->
                <div style="text-align: center;">
                    <canvas id="sumChart" width="1000" height="600" style="max-width: 100%; border: 2px solid #4ecdc4; border-radius: 10px; background: rgba(255, 255, 255, 0.02);"></canvas>
                </div>
                
                <!-- Mini Charts Panel -->
                <div style="display: grid; grid-template-rows: repeat(2, 1fr); gap: 15px;">
                    <div style="background: rgba(40, 40, 60, 0.6); border-radius: 10px; padding: 15px;">
                        <h5 style="color: #4ecdc4; margin: 0 0 10px 0; font-size: 14px;">Ratio Overview</h5>
                        <canvas id="miniChart1" width="300" height="200" style="width: 100%; height: auto; border-radius: 5px;"></canvas>
                    </div>
                    <div style="background: rgba(40, 40, 60, 0.6); border-radius: 10px; padding: 15px;">
                        <h5 style="color: #4ecdc4; margin: 0 0 10px 0; font-size: 14px;">Alpha Distribution</h5>
                        <canvas id="miniChart2" width="300" height="200" style="width: 100%; height: auto; border-radius: 5px;"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Real-time Statistics Dashboard -->
            <div style="background: rgba(40, 40, 60, 0.8); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.1);">
                <h4 style="color: #4ecdc4; margin-bottom: 15px;">üìä Real-time Analytics Dashboard</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="background: linear-gradient(135deg, rgba(78, 205, 196, 0.2), rgba(68, 160, 141, 0.1)); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #4ecdc4;" id="statMaxRatio">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">Maximum Ratio</div>
                        <div style="color: #c0c0c0; font-size: 10px; margin-top: 5px;" id="statMaxAlpha">-</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(255, 154, 86, 0.2), rgba(255, 123, 123, 0.1)); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #ff9a56;" id="statViolations">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">RH Violations</div>
                        <div style="color: #c0c0c0; font-size: 10px; margin-top: 5px;">Ratio > 3.0</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(254, 202, 87, 0.2), rgba(255, 159, 67, 0.1)); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #feca57;" id="statMajorArcs">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">Major Arc Hits</div>
                        <div style="color: #c0c0c0; font-size: 10px; margin-top: 5px;">Rational Œ± Values</div>
                    </div>
                    <div style="background: linear-gradient(135deg, rgba(150, 206, 180, 0.2), rgba(68, 160, 141, 0.1)); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #96ceb4;" id="statEfficiency">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">RH Efficiency</div>
                        <div style="color: #c0c0c0; font-size: 10px; margin-top: 5px;">% Below ‚àöN</div>
                    </div>
                </div>
            </div>

            <!-- Interactive Data Explorer -->
            <div style="background: rgba(40, 40, 60, 0.8); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                <h4 style="color: #4ecdc4; margin-bottom: 15px;">üîç Advanced Data Explorer</h4>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <!-- Smart Search -->
                    <div>
                        <label style="color: #c0c0c0; margin-bottom: 5px; display: block;">üéØ Smart Œ± Search:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="alphaSearch" placeholder="e.g., 1/6, 0.5, 0.16667" style="flex: 1; padding: 8px;">
                            <button onclick="searchAlpha()" style="background: #667eea; padding: 8px 15px; border: none; border-radius: 5px; color: white; cursor: pointer;">üîç</button>
                        </div>
                        <div id="alphaSearchResult" style="margin-top: 10px; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: 5px; display: none;">
                        </div>
                    </div>
                    
                    <!-- Statistical Range -->
                    <div>
                        <label style="color: #c0c0c0; margin-bottom: 5px; display: block;">üìä Statistical Range:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="number" id="minSum" placeholder="Min" style="width: 80px; padding: 8px;" step="0.1">
                            <span style="color: #a0a0a0;">to</span>
                            <input type="number" id="maxSum" placeholder="Max" style="width: 80px; padding: 8px;" step="0.1">
                            <button onclick="applyRangeFilter()" style="background: #667eea; padding: 8px 15px; border: none; border-radius: 5px; color: white; cursor: pointer;">Filter</button>
                        </div>
                        <div id="rangeFilterResult" style="margin-top: 10px; color: #a0a0a0; font-size: 12px;"></div>
                    </div>

                    <!-- Pattern Analysis -->
                    <div>
                        <label style="color: #c0c0c0; margin-bottom: 5px; display: block;">üî¨ Pattern Analysis:</label>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button onclick="analyzePatterns('peaks')" style="background: #4ecdc4; padding: 6px 12px; border: none; border-radius: 5px; color: white; cursor: pointer; font-size: 12px;">Find Peaks</button>
                            <button onclick="analyzePatterns('clusters')" style="background: #ff9a56; padding: 6px 12px; border: none; border-radius: 5px; color: white; cursor: pointer; font-size: 12px;">Clusters</button>
                            <button onclick="analyzePatterns('outliers')" style="background: #ff6b6b; padding: 6px 12px; border: none; border-radius: 5px; color: white; cursor: pointer; font-size: 12px;">Outliers</button>
                        </div>
                        <div id="patternResult" style="margin-top: 10px; color: #a0a0a0; font-size: 12px;"></div>
                    </div>
                </div>
                
                <!-- Enhanced Data Table with Advanced Features -->
                <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; flex-wrap: wrap; gap: 10px;">
                        <h5 style="color: #4ecdc4; margin: 0;">Complete Dataset Explorer</h5>
                        <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                            <span id="fullDataCount" style="color: #a0a0a0; font-size: 12px;"></span>
                            <select id="tablePageSize" style="padding: 5px; font-size: 12px;" onchange="updateTablePagination()">
                                <option value="50">Show 50</option>
                                <option value="100" selected>Show 100</option>
                                <option value="200">Show 200</option>
                                <option value="all">Show All</option>
                            </select>
                            <button onclick="exportData()" style="background: #96ceb4; padding: 6px 12px; border: none; border-radius: 5px; color: white; cursor: pointer; font-size: 12px;">üìä Export CSV</button>
                            <button onclick="generateReport()" style="background: #feca57; padding: 6px 12px; border: none; border-radius: 5px; color: white; cursor: pointer; font-size: 12px;">üìÑ Report</button>
                        </div>
                    </div>
                    
                    <div style="max-height: 500px; overflow-y: auto; border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(20, 20, 30, 0.9);">
                        <table style="width: 100%; border-collapse: collapse;" id="fullDataTable">
                            <thead style="position: sticky; top: 0; background: rgba(30, 30, 45, 0.95); z-index: 10;">
                                <tr>
                                    <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid rgba(255, 255, 255, 0.2); color: #4ecdc4; cursor: pointer; user-select: none;" onclick="sortTable('rank')">
                                        üìä Rank <span id="sort-rank" style="float: right;">‚ÜïÔ∏è</span>
                                    </th>
                                    <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid rgba(255, 255, 255, 0.2); color: #4ecdc4; cursor: pointer; user-select: none;" onclick="sortTable('alpha')">
                                        üéØ Œ± Value <span id="sort-alpha" style="float: right;">‚ÜïÔ∏è</span>
                                    </th>
                                    <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid rgba(255, 255, 255, 0.2); color: #4ecdc4; cursor: pointer; user-select: none;" onclick="sortTable('sum')">
                                        üìà |S(N,Œ±)| <span id="sort-sum" style="float: right;">‚ÜïÔ∏è</span>
                                    </th>
                                    <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid rgba(255, 255, 255, 0.2); color: #4ecdc4; cursor: pointer; user-select: none;" onclick="sortTable('ratio')">
                                        ‚öñÔ∏è Ratio <span id="sort-ratio" style="float: right;">‚ÜïÔ∏è</span>
                                    </th>
                                    <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid rgba(255, 255, 255, 0.2); color: #4ecdc4;">
                                        üè∑Ô∏è Type
                                    </th>
                                    <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid rgba(255, 255, 255, 0.2); color: #4ecdc4;">
                                        üîç Action
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="fullDataBody">
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination Controls -->
                    <div id="paginationControls" style="margin-top: 15px; text-align: center; display: none;">
                        <button onclick="changePage(-1)" style="background: #667eea; padding: 8px 15px; margin: 0 5px; border: none; border-radius: 5px; color: white; cursor: pointer;">‚Üê Previous</button>
                        <span id="pageInfo" style="color: #c0c0c0; margin: 0 15px;"></span>
                        <button onclick="changePage(1)" style="background: #667eea; padding: 8px 15px; margin: 0 5px; border: none; border-radius: 5px; color: white; cursor: pointer;">Next ‚Üí</button>
                    </div>
                </div>
                
                <!-- Enhanced Quick Stats with Trends -->
                <div style="margin-top: 25px;">
                    <h5 style="color: #4ecdc4; margin-bottom: 15px;">üìà Advanced Statistics & Trends</h5>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statTotal">-</div>
                            <div style="color: #a0a0a0; font-size: 12px;">Total Values</div>
                        </div>
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statRational">-</div>
                            <div style="color: #a0a0a0; font-size: 12px;">Rational Œ±</div>
                        </div>
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statAboveSqrt">-</div>
                            <div style="color: #a0a0a0; font-size: 12px;">Above ‚àöN</div>
                        </div>
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statAvgRatio">-</div>
                            <div style="color: #a0a0a0; font-size: 12px;">Avg Ratio</div>
                        </div>
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statStdDev">-</div>
                            <div style="color: #a0a0a0; font-size: 12px;">Std Deviation</div>
                        </div>
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statMedian">-</div>
                            <div style="color: #a0a0a0; font-size: 12px;">Median Ratio</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statTotal">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">Total Values</div>
                    </div>
                    <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statRational">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">Rational Œ±</div>
                    </div>
                    <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statAboveSqrt">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">Above ‚àöN</div>
                    </div>
                    <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;" id="statAvgRatio">-</div>
                        <div style="color: #a0a0a0; font-size: 12px;">Avg Ratio</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class RiemannHypothesisTester {
            constructor() {
                this.mobius = [];
                this.maxN = 0;
                this.isComputing = false;
            }

            // Optimized M√∂bius function computation using sieve method
            computeMobius(n) {
                console.log('Computing M√∂bius function up to ' + n + '...');
                const startTime = performance.now();
                
                this.mobius = new Int8Array(n + 1);
                const smallestPrimeFactor = new Array(n + 1).fill(0);
                
                // Initialize
                this.mobius[1] = 1;
                
                // Sieve to find smallest prime factors
                for (let i = 2; i <= n; i++) {
                    if (smallestPrimeFactor[i] === 0) {
                        // i is prime
                        smallestPrimeFactor[i] = i;
                        for (let j = i * i; j <= n; j += i) {
                            if (smallestPrimeFactor[j] === 0) {
                                smallestPrimeFactor[j] = i;
                            }
                        }
                    }
                }
                
                // Compute M√∂bius function using multiplicative property
                for (let i = 2; i <= n; i++) {
                    const p = smallestPrimeFactor[i];
                    const quotient = Math.floor(i / p);
                    
                    if (quotient % p === 0) {
                        // i is divisible by p¬≤, so Œº(i) = 0
                        this.mobius[i] = 0;
                    } else {
                        // Œº(i) = -Œº(i/p) since p is the smallest prime factor
                        this.mobius[i] = -this.mobius[quotient];
                    }
                }
                
                const endTime = performance.now();
                console.log('M√∂bius computation completed in ' + (endTime - startTime).toFixed(2) + 'ms');
                this.maxN = n;
            }

            // Compute exponential sum S(N, Œ±)
            computeExponentialSum(N, alpha) {
                let realSum = 0;
                let imagSum = 0;
                
                for (let n = 1; n <= N; n++) {
                    if (this.mobius[n] !== 0) {
                        const angle = 2 * Math.PI * n * alpha;
                        realSum += this.mobius[n] * Math.cos(angle);
                        imagSum += this.mobius[n] * Math.sin(angle);
                    }
                }
                
                return Math.sqrt(realSum * realSum + imagSum * imagSum);
            }

            // Generate test Œ± values based on mode
            generateAlphaValues(mode, numSamples, maxDenom) {
                const alphas = [];
                
                switch (mode) {
                    case 'stochastic':
                        for (let i = 0; i < numSamples; i++) {
                            alphas.push(Math.random());
                        }
                        break;
                        
                    case 'major-arcs':
                        // Test rational numbers with small denominators
                        for (let q = 1; q <= maxDenom; q++) {
                            for (let p = 0; p < q; p++) {
                                if (this.gcd(p, q) === 1) {
                                    alphas.push(p / q);
                                }
                            }
                        }
                        // Add some random values too
                        for (let i = 0; i < Math.min(50, numSamples); i++) {
                            alphas.push(Math.random());
                        }
                        break;
                        
                    case 'uniform':
                        for (let i = 0; i < numSamples; i++) {
                            alphas.push(i / numSamples);
                        }
                        break;
                        
                    case 'comprehensive':
                        // Combine all methods for thorough testing
                        // Major arcs
                        for (let q = 1; q <= maxDenom; q++) {
                            for (let p = 0; p < q; p++) {
                                if (this.gcd(p, q) === 1) {
                                    alphas.push(p / q);
                                }
                            }
                        }
                        // Uniform sampling
                        for (let i = 0; i < Math.floor(numSamples / 2); i++) {
                            alphas.push(i / Math.floor(numSamples / 2));
                        }
                        // Random sampling
                        for (let i = 0; i < Math.floor(numSamples / 2); i++) {
                            alphas.push(Math.random());
                        }
                        break;
                }
                
                return [...new Set(alphas)]; // Remove duplicates
            }

            gcd(a, b) {
                while (b !== 0) {
                    [a, b] = [b, a % b];
                }
                return a;
            }

            formatAlpha(alpha) {
                // Try to express as a simple fraction
                const tolerance = 1e-10;
                for (let denom = 1; denom <= 12; denom++) {
                    for (let num = 0; num < denom; num++) {
                        if (Math.abs(alpha - num/denom) < tolerance && this.gcd(num, denom) === 1) {
                            return num + '/' + denom;
                        }
                    }
                }
                return alpha.toFixed(6);
            }

            async runVerification(maxN, testMode, numSamples, maxDenom) {
                return new Promise((resolve) => {
                    const startTime = performance.now();
                    
                    // Update UI
                    document.getElementById('progressContainer').style.display = 'block';
                    document.getElementById('results').style.display = 'none';
                    document.getElementById('visualization').style.display = 'none';
                    
                    const updateProgress = (message, progress) => {
                        document.getElementById('statusText').textContent = message;
                        document.getElementById('progressFill').style.width = progress + '%';
                    };
                    
                    setTimeout(() => {
                        updateProgress('Computing M√∂bius function...', 10);
                        
                        setTimeout(() => {
                            // Step 1: Compute M√∂bius function
                            this.computeMobius(maxN);
                            updateProgress('Generating Œ± test values...', 30);
                            
                            setTimeout(() => {
                                // Step 2: Generate Œ± values
                                const alphas = this.generateAlphaValues(testMode, numSamples, maxDenom);
                                updateProgress('Testing ' + alphas.length + ' Œ± values...', 50);
                                
                                setTimeout(() => {
                                    // Step 3: Test exponential sums
                                    let maxSum = 0;
                                    let bestAlpha = 0;
                                    const results = [];
                                    
                                    alphas.forEach((alpha, i) => {
                                        const sum = this.computeExponentialSum(maxN, alpha);
                                        results.push({alpha, sum});
                                        
                                        if (sum > maxSum) {
                                            maxSum = sum;
                                            bestAlpha = alpha;
                                        }
                                        
                                        if (i % Math.max(1, Math.floor(alphas.length / 10)) === 0) {
                                            const progress = 50 + 40 * (i / alphas.length);
                                            updateProgress('Testing Œ± values... ' + (i + 1) + '/' + alphas.length, progress);
                                        }
                                    });
                                    
                                    const endTime = performance.now();
                                    const computeTime = endTime - startTime;
                                    const sqrtN = Math.sqrt(maxN);
                                    const ratio = maxSum / sqrtN;
                                    
                                    updateProgress('Computation complete!', 100);
                                    
                                    resolve({
                                        maxN,
                                        sqrtN,
                                        maxSum,
                                        ratio,
                                        bestAlpha,
                                        computeTime,
                                        results: results.sort((a, b) => b.sum - a.sum) // Keep all results, not just top 20
                                    });
                                }, 100);
                            }, 100);
                        }, 100);
                    }, 100);
                });
            }

            displayResults(results) {
                const {maxN, sqrtN, maxSum, ratio, bestAlpha, computeTime, results: topResults} = results;
                
                document.getElementById('resultN').textContent = maxN.toLocaleString();
                document.getElementById('resultSqrtN').textContent = sqrtN.toFixed(2);
                document.getElementById('resultMaxSum').textContent = maxSum.toFixed(4);
                document.getElementById('resultRatio').textContent = ratio.toFixed(6);
                document.getElementById('resultBestAlpha').textContent = this.formatAlpha(bestAlpha);
                document.getElementById('computeTime').textContent = (computeTime/1000).toFixed(2) + 's';
                document.getElementById('opsPerSec').textContent = (maxN / (computeTime/1000)).toExponential(2);
                
                // Enhanced RH status with cosmic themes
                let rhStatus, rhClass;
                if (ratio < 0.3) {
                    rhStatus = 'üåå COSMIC - Exceptional RH Support (ratio < 0.3)';
                    rhClass = 'status-cosmic';
                } else if (ratio < 0.6) {
                    rhStatus = 'üåü LEGENDARY - Outstanding RH Support (ratio < 0.6)';
                    rhClass = 'status-legendary';
                } else if (ratio < 1.0) {
                    rhStatus = '‚ú® MYTHICAL - Excellent RH Support (ratio < 1.0)';
                    rhClass = 'status-mythical';
                } else if (ratio < 2.0) {
                    rhStatus = '‚≠ê EXCELLENT - Good RH Support (ratio < 2.0)';
                    rhClass = 'status-excellent';
                } else if (ratio < 3.0) {
                    rhStatus = 'üëç GOOD - Acceptable RH Support (ratio < 3.0)';
                    rhClass = 'status-good';
                } else {
                    rhStatus = '‚ö†Ô∏è HIGH - Needs Investigation (ratio ‚â• 3.0)';
                    rhClass = 'status-high';
                }
                
                const statusElement = document.getElementById('cosmicStatus');
                statusElement.textContent = rhStatus;
                statusElement.className = 'cosmic-status ' + rhClass;
                statusElement.style.display = 'block';
                
                // Show detailed results if enabled
                const showDetails = document.getElementById('showDetails').checked;
                if (showDetails) {
                    this.displayDetailedResults(topResults, maxN, sqrtN, ratio);
                    document.getElementById('detailedResults').style.display = 'block';
                } else {
                    document.getElementById('detailedResults').style.display = 'none';
                }
                
                document.getElementById('results').style.display = 'block';
                document.getElementById('progressContainer').style.display = 'none';
                
                this.visualizeResults(topResults, maxN);
            }

            displayDetailedResults(topResults, maxN, sqrtN, ratio) {
                // Store all results for dropdown filtering
                this.allResults = topResults;
                this.currentMaxN = maxN;
                this.currentSqrtN = sqrtN;
                
                // Set up dropdown event listener
                const resultsView = document.getElementById('resultsView');
                resultsView.onchange = () => this.updateResultsTable();
                
                // Initial display
                this.updateResultsTable();
                
                // Mathematical insights
                const insights = this.generateInsights(topResults, maxN, sqrtN, ratio);
                document.getElementById('insights').innerHTML = insights;
            }

            updateResultsTable() {
                const viewType = document.getElementById('resultsView').value;
                const tbody = document.getElementById('topResults');
                const resultsCount = document.getElementById('resultsCount');
                
                let filteredResults = [];
                
                switch (viewType) {
                    case 'top10':
                        filteredResults = this.allResults.slice(0, 10);
                        break;
                    case 'top20':
                        filteredResults = this.allResults.slice(0, 20);
                        break;
                    case 'top50':
                        filteredResults = this.allResults.slice(0, 50);
                        break;
                    case 'all':
                        filteredResults = this.allResults;
                        break;
                    case 'rational':
                        filteredResults = this.allResults.filter(r => this.isSimpleRational(r.alpha));
                        break;
                    case 'above-sqrt':
                        filteredResults = this.allResults.filter(r => r.sum > this.currentSqrtN);
                        break;
                }
                
                // Update count display
                resultsCount.textContent = 'Showing ' + filteredResults.length + ' of ' + this.allResults.length + ' values';
                
                // Clear and populate table
                tbody.innerHTML = '';
                
                filteredResults.forEach((result, i) => {
                    const resultRatio = result.sum / this.currentSqrtN;
                    const actualRank = this.allResults.indexOf(result) + 1;
                    
                    // Determine alpha type
                    let alphaType = 'Random';
                    if (this.isSimpleRational(result.alpha)) {
                        alphaType = 'Rational';
                    } else if (Math.abs(result.alpha - Math.round(result.alpha)) < 1e-10) {
                        alphaType = 'Integer';
                    } else if (result.alpha < 0.01 || result.alpha > 0.99) {
                        alphaType = 'Near edge';
                    }
                    
                    const row = document.createElement('tr');
                    
                    // Color code high ratios
                    let rowStyle = '';
                    if (resultRatio > 2.0) {
                        rowStyle = 'background-color: rgba(255, 107, 107, 0.1);';
                    } else if (resultRatio > 1.0) {
                        rowStyle = 'background-color: rgba(255, 159, 67, 0.1);';
                    } else if (resultRatio > 0.7) {
                        rowStyle = 'background-color: rgba(78, 205, 196, 0.1);';
                    }
                    
                    row.style.cssText = rowStyle;
                    row.innerHTML = 
                        '<td>' + actualRank + '</td>' +
                        '<td>' + this.formatAlpha(result.alpha) + '</td>' +
                        '<td>' + result.sum.toFixed(4) + '</td>' +
                        '<td style="font-weight: bold; color: ' + (resultRatio > 1.0 ? '#ff6b6b' : '#4ecdc4') + ';">' + resultRatio.toFixed(4) + '</td>' +
                        '<td style="font-size: 11px; color: #a0a0a0;">' + alphaType + '</td>';
                    tbody.appendChild(row);
                });
                
                // Add summary row if showing subset
                if (viewType !== 'all' && filteredResults.length < this.allResults.length) {
                    const summaryRow = document.createElement('tr');
                    summaryRow.style.cssText = 'border-top: 2px solid #4ecdc4; font-style: italic; color: #a0a0a0;';
                    summaryRow.innerHTML = 
                        '<td colspan="5" style="text-align: center; padding: 15px;">... ' + 
                        (this.allResults.length - filteredResults.length) + 
                        ' more values available (select "All Values" to see complete list)</td>';
                    tbody.appendChild(summaryRow);
                }
            }

            generateInsights(topResults, maxN, sqrtN, ratio) {
                let insights = '';
                
                // Analyze all results for better insights
                const allRatios = topResults.map(r => r.sum / sqrtN);
                const rationalAlphas = topResults.filter(r => this.isSimpleRational(r.alpha));
                const highRatios = topResults.filter(r => r.sum / sqrtN > 1.0);
                
                // Statistical summary
                const avgRatio = allRatios.reduce((a, b) => a + b, 0) / allRatios.length;
                const maxRatio = Math.max(...allRatios);
                
                insights += '<p><strong>Statistical Summary:</strong> Tested ' + topResults.length + ' Œ± values. Average ratio: ' + avgRatio.toFixed(4) + ', Maximum ratio: ' + maxRatio.toFixed(4) + '.</p>';
                
                // Major arc analysis
                if (rationalAlphas.length > 0) {
                    const rationalPercentage = ((rationalAlphas.length / topResults.length) * 100).toFixed(1);
                    const topRationalCount = rationalAlphas.slice(0, 10).length;
                    insights += '<p><strong>Major Arc Dominance:</strong> ' + rationalAlphas.length + ' rational Œ± values (' + rationalPercentage + '% of all tested). ' + topRationalCount + ' of top 10 results are at rational points, confirming major arc theory.</p>';
                }
                
                // High ratio analysis
                if (highRatios.length > 0) {
                    insights += '<p><strong>Above ‚àöN Analysis:</strong> ' + highRatios.length + ' values exceed the ‚àöN bound (' + sqrtN.toFixed(2) + '). This represents ' + ((highRatios.length / topResults.length) * 100).toFixed(1) + '% of all tested values.</p>';
                }
                
                // RH interpretation
                if (ratio < 1.0) {
                    insights += '<p><strong>RH Interpretation:</strong> The maximum ratio ' + ratio.toFixed(4) + ' is well below the ‚àöN bound, providing strong computational evidence supporting the Riemann Hypothesis for N = ' + maxN.toLocaleString() + '.</p>';
                } else if (ratio < 2.0) {
                    insights += '<p><strong>RH Interpretation:</strong> The ratio ' + ratio.toFixed(4) + ' remains reasonably bounded, consistent with RH predictions though higher than ideal.</p>';
                } else {
                    insights += '<p><strong>RH Interpretation:</strong> The ratio ' + ratio.toFixed(4) + ' is elevated. While still potentially consistent with RH (which allows O(‚àöN) behavior), this warrants further investigation.</p>';
                }
                
                // Pattern analysis
                const topAlphaTypes = topResults.slice(0, 5).map(r => this.isSimpleRational(r.alpha) ? 'rational' : 'irrational');
                const rationalInTop5 = topAlphaTypes.filter(t => t === 'rational').length;
                if (rationalInTop5 >= 3) {
                    insights += '<p><strong>Pattern Analysis:</strong> Rational Œ± values dominate the top results (' + rationalInTop5 + '/5), suggesting strong major arc effects in the exponential sum structure.</p>';
                }
                
                // Computational achievement
                insights += '<p><strong>Computational Achievement:</strong> Successfully verified RH predictions for ' + maxN.toLocaleString() + ' integers using ' + topResults.length + ' Œ± samples in a web browser, demonstrating the power of modern JavaScript engines for mathematical research.</p>';
                
                // Research directions
                insights += '<p><strong>Research Directions:</strong> Use the dropdown above to explore specific patterns - examine rational Œ± values for major arc effects, or filter for values above ‚àöN to investigate potential RH violations.</p>';
                
                return insights;
            }

            isSimpleRational(alpha) {
                const tolerance = 1e-8;
                for (let denom = 1; denom <= 20; denom++) {
                    for (let num = 0; num < denom; num++) {
                        if (Math.abs(alpha - num/denom) < tolerance && this.gcd(num, denom) === 1) {
                            return true;
                        }
                    }
                }
                return false;
            }

            visualizeResults(results, maxN) {
                // Store results for interactive features
                this.visualizationData = {
                    results: results,
                    maxN: maxN,
                    sqrtN: Math.sqrt(maxN)
                };
                
                // Initialize pagination
                this.currentPage = 1;
                this.pageSize = 100;
                
                // Update all statistics and displays
                this.updateAdvancedStats();
                this.updateInteractiveStats();
                this.populateFullDataTable();
                this.createMiniCharts();
                this.updateVisualization();
                
                document.getElementById('visualization').style.display = 'block';
            }

            updateAdvancedStats() {
                const { results, sqrtN } = this.visualizationData;
                const ratios = results.map(r => r.sum / sqrtN);
                const rationalCount = results.filter(r => this.isSimpleRational(r.alpha)).length;
                const aboveSqrtCount = results.filter(r => r.sum > sqrtN).length;
                const violationCount = results.filter(r => (r.sum / sqrtN) > 3.0).length;
                
                // Statistical calculations
                const avgRatio = ratios.reduce((sum, r) => sum + r, 0) / ratios.length;
                const maxRatio = Math.max(...ratios);
                const maxRatioIndex = ratios.indexOf(maxRatio);
                const maxAlpha = results[maxRatioIndex].alpha;
                const efficiency = ((results.length - aboveSqrtCount) / results.length * 100);
                
                // Standard deviation
                const variance = ratios.reduce((sum, r) => sum + Math.pow(r - avgRatio, 2), 0) / ratios.length;
                const stdDev = Math.sqrt(variance);
                
                // Median
                const sortedRatios = [...ratios].sort((a, b) => a - b);
                const median = sortedRatios[Math.floor(sortedRatios.length / 2)];
                
                // Update real-time dashboard
                document.getElementById('statMaxRatio').textContent = maxRatio.toFixed(4);
                document.getElementById('statMaxAlpha').textContent = 'Œ± = ' + this.formatAlpha(maxAlpha);
                document.getElementById('statViolations').textContent = violationCount;
                document.getElementById('statMajorArcs').textContent = rationalCount;
                document.getElementById('statEfficiency').textContent = efficiency.toFixed(1) + '%';
                
                // Update detailed stats
                document.getElementById('statTotal').textContent = results.length.toLocaleString();
                document.getElementById('statRational').textContent = rationalCount.toLocaleString();
                document.getElementById('statAboveSqrt').textContent = aboveSqrtCount.toLocaleString();
                document.getElementById('statAvgRatio').textContent = avgRatio.toFixed(3);
                document.getElementById('statStdDev').textContent = stdDev.toFixed(3);
                document.getElementById('statMedian').textContent = median.toFixed(3);
            }

            createMiniCharts() {
                this.drawMiniRatioChart();
                this.drawMiniAlphaChart();
            }

            drawMiniRatioChart() {
                const canvas = document.getElementById('miniChart1');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const { results, sqrtN } = this.visualizationData;
                const ratios = results.map(r => r.sum / sqrtN);
                
                // Create histogram of ratios
                const bins = 20;
                const minRatio = Math.min(...ratios);
                const maxRatio = Math.max(...ratios);
                const binWidth = (maxRatio - minRatio) / bins;
                const histogram = new Array(bins).fill(0);
                
                ratios.forEach(ratio => {
                    const binIndex = Math.min(bins - 1, Math.floor((ratio - minRatio) / binWidth));
                    histogram[binIndex]++;
                });
                
                const maxBin = Math.max(...histogram);
                const padding = 20;
                const width = canvas.width - 2 * padding;
                const height = canvas.height - 2 * padding;
                
                // Draw bars
                histogram.forEach((count, i) => {
                    const x = padding + (i / bins) * width;
                    const barWidth = width / bins * 0.8;
                    const barHeight = (count / maxBin) * height;
                    const y = canvas.height - padding - barHeight;
                    
                    const ratioValue = minRatio + (i + 0.5) * binWidth;
                    ctx.fillStyle = ratioValue > 1.0 ? '#ff6b6b' : '#4ecdc4';
                    ctx.fillRect(x, y, barWidth, barHeight);
                });
                
                // Draw ‚àöN reference line
                const ratio1X = padding + ((1.0 - minRatio) / (maxRatio - minRatio)) * width;
                ctx.strokeStyle = '#ff6b6b';
                ctx.lineWidth = 2;
                ctx.setLineDash([3, 3]);
                ctx.beginPath();
                ctx.moveTo(ratio1X, padding);
                ctx.lineTo(ratio1X, canvas.height - padding);
                ctx.stroke();
                ctx.setLineDash([]);
            }

            drawMiniAlphaChart() {
                const canvas = document.getElementById('miniChart2');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const { results } = this.visualizationData;
                const padding = 20;
                const width = canvas.width - 2 * padding;
                const height = canvas.height - 2 * padding;
                
                // Show top 50 results as alpha distribution
                const topResults = results.slice(0, 50);
                const maxSum = Math.max(...topResults.map(r => r.sum));
                
                topResults.forEach((result, i) => {
                    const x = padding + result.alpha * width;
                    const y = canvas.height - padding - (result.sum / maxSum) * height;
                    
                    ctx.fillStyle = this.isSimpleRational(result.alpha) ? '#feca57' : '#4ecdc4';
                    ctx.beginPath();
                    ctx.arc(x, y, 2, 0, 2 * Math.PI);
                    ctx.fill();
                });
            }

            updateVisualization() {
                const chartType = document.getElementById('chartType').value;
                const dataFilter = document.getElementById('dataFilter').value;
                const yScale = document.getElementById('yScale').value;
                const animate = document.getElementById('animateChart').checked;
                
                let filteredData = this.getFilteredData(dataFilter);
                
                switch (chartType) {
                    case 'scatter':
                        this.drawScatterPlot(filteredData, yScale, true);
                        break;
                    case 'histogram':
                        this.drawHistogram(filteredData, yScale);
                        break;
                    case 'ratio-distribution':
                        this.drawRatioDistribution(filteredData);
                        break;
                    case 'alpha-vs-sum':
                        this.drawAlphaVsSum(filteredData, yScale, true);
                        break;
                    case '3d-surface':
                        this.draw3DSurface(filteredData);
                        break;
                    case 'heatmap':
                        this.drawHeatmap(filteredData);
                        break;
                    case 'polar':
                        this.drawPolarPlot(filteredData);
                        break;
                    case 'complex-plane':
                        this.drawComplexPlane(filteredData);
                        break;
                }
                
                if (animate) {
                    this.animateChart();
                }
            }

            getFilteredData(filter) {
                const { results, sqrtN } = this.visualizationData;
                
                switch (filter) {
                    case 'top50':
                        return results.slice(0, 50);
                    case 'top100':
                        return results.slice(0, 100);
                    case 'rational':
                        return results.filter(r => this.isSimpleRational(r.alpha));
                    case 'above-sqrt':
                        return results.filter(r => r.sum > sqrtN);
                    case 'below-sqrt':
                        return results.filter(r => r.sum <= sqrtN);
                    case 'major-arcs':
                        return results.filter(r => {
                            // Check if Œ± ‚âà a/q for small q
                            for (let q = 1; q <= 12; q++) {
                                for (let a = 0; a < q; a++) {
                                    if (this.gcd(a, q) === 1 && Math.abs(r.alpha - a/q) < 1e-10) {
                                        return true;
                                    }
                                }
                            }
                            return false;
                        });
                    default:
                        return results;
                }
            }

            draw3DSurface(data) {
                const canvas = document.getElementById('sumChart');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const padding = 80;
                const width = canvas.width - 2 * padding;
                const height = canvas.height - 2 * padding;
                
                // Create a pseudo-3D effect by plotting alpha vs rank vs sum
                const maxSum = Math.max(...data.map(r => r.sum));
                
                // Draw grid lines for 3D effect
                ctx.strokeStyle = 'rgba(78, 205, 196, 0.2)';
                ctx.lineWidth = 1;
                
                for (let i = 0; i <= 10; i++) {
                    const x = padding + (i / 10) * width;
                    ctx.beginPath();
                    ctx.moveTo(x, padding);
                    ctx.lineTo(x, canvas.height - padding);
                    ctx.stroke();
                    
                    const y = padding + (i / 10) * height;
                    ctx.beginPath();
                    ctx.moveTo(padding, y);
                    ctx.lineTo(canvas.width - padding, y);
                    ctx.stroke();
                }
                
                // Plot data points with 3D perspective
                data.forEach((result, i) => {
                    const x = padding + result.alpha * width;
                    const baseY = canvas.height - padding - (result.sum / maxSum) * height;
                    const perspectiveOffset = (i / data.length) * 30; // Fake depth
                    const y = baseY - perspectiveOffset;
                    
                    // Shadow effect
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
                    ctx.beginPath();
                    ctx.arc(x + 2, baseY + 2, 3, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    // Main point
                    const ratio = result.sum / this.visualizationData.sqrtN;
                    ctx.fillStyle = ratio > 1.0 ? '#ff6b6b' : '#4ecdc4';
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    // Connection line for 3D effect
                    ctx.strokeStyle = 'rgba(78, 205, 196, 0.3)';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                    ctx.lineTo(x, baseY);
                    ctx.stroke();
                });
                
                // Labels
                ctx.fillStyle = '#e0e0e0';
                ctx.font = '16px Arial';
                ctx.fillText('Œ± Value (X-axis)', canvas.width / 2 - 50, canvas.height - 20);
                ctx.fillText('3D Surface: Œ± √ó Rank √ó |S(N,Œ±)|', padding, 30);
            }

            drawHeatmap(data) {
                const canvas = document.getElementById('sumChart');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const padding = 80;
                const width = canvas.width - 2 * padding;
                const height = canvas.height - 2 * padding;
                
                // Create 2D grid
                const gridSize = 20;
                const heatmap = Array(gridSize).fill().map(() => Array(gridSize).fill(0));
                const countMap = Array(gridSize).fill().map(() => Array(gridSize).fill(0));
                
                const maxSum = Math.max(...data.map(r => r.sum));
                
                // Populate heatmap
                data.forEach((result, index) => {
                    const alphaIndex = Math.floor(result.alpha * gridSize);
                    const sumIndex = Math.floor((result.sum / maxSum) * gridSize);
                    
                    if (alphaIndex < gridSize && sumIndex < gridSize) {
                        heatmap[sumIndex][alphaIndex] += result.sum;
                        countMap[sumIndex][alphaIndex]++;
                    }
                });
                
                // Average the values
                for (let i = 0; i < gridSize; i++) {
                    for (let j = 0; j < gridSize; j++) {
                        if (countMap[i][j] > 0) {
                            heatmap[i][j] /= countMap[i][j];
                        }
                    }
                }
                
                const maxHeat = Math.max(...heatmap.flat());
                
                // Draw heatmap
                const cellWidth = width / gridSize;
                const cellHeight = height / gridSize;
                
                for (let i = 0; i < gridSize; i++) {
                    for (let j = 0; j < gridSize; j++) {
                        if (heatmap[i][j] > 0) {
                            const intensity = heatmap[i][j] / maxHeat;
                            const red = Math.floor(255 * intensity);
                            const blue = Math.floor(255 * (1 - intensity));
                            
                            ctx.fillStyle = `rgb(${red}, 100, ${blue})`;
                            ctx.fillRect(
                                padding + j * cellWidth,
                                canvas.height - padding - (i + 1) * cellHeight,
                                cellWidth,
                                cellHeight
                            );
                        }
                    }
                }
                
                // Labels
                ctx.fillStyle = '#e0e0e0';
                ctx.font = '16px Arial';
                ctx.fillText('Alpha Heatmap: Œ± vs |S(N,Œ±)| Intensity', padding, 30);
                ctx.fillText('Œ± Value', canvas.width / 2 - 30, canvas.height - 20);
                
                ctx.save();
                ctx.translate(25, canvas.height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('|S(N,Œ±)|', -30, 0);
                ctx.restore();
            }

            drawPolarPlot(data) {
                const canvas = document.getElementById('sumChart');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const maxRadius = Math.min(centerX, centerY) - 50;
                
                const { sqrtN } = this.visualizationData;
                const maxSum = Math.max(...data.map(r => r.sum));
                
                // Draw polar grid
                ctx.strokeStyle = 'rgba(78, 205, 196, 0.2)';
                ctx.lineWidth = 1;
                
                // Concentric circles
                for (let i = 1; i <= 5; i++) {
                    const radius = (i / 5) * maxRadius;
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                    ctx.stroke();
                }
                
                // Radial lines
                for (let i = 0; i < 12; i++) {
                    const angle = (i / 12) * 2 * Math.PI;
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.lineTo(
                        centerX + Math.cos(angle) * maxRadius,
                        centerY + Math.sin(angle) * maxRadius
                    );
                    ctx.stroke();
                }
                
                // Plot data in polar coordinates
                data.forEach(result => {
                    const angle = result.alpha * 2 * Math.PI;
                    const radius = (result.sum / maxSum) * maxRadius;
                    
                    const x = centerX + Math.cos(angle) * radius;
                    const y = centerY + Math.sin(angle) * radius;
                    
                    const ratio = result.sum / sqrtN;
                    ctx.fillStyle = ratio > 1.0 ? '#ff6b6b' : '#4ecdc4';
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                });
                
                // ‚àöN reference circle
                const sqrtNRadius = (sqrtN / maxSum) * maxRadius;
                ctx.strokeStyle = '#ff6b6b';
                ctx.lineWidth = 3;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.arc(centerX, centerY, sqrtNRadius, 0, 2 * Math.PI);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // Labels
                ctx.fillStyle = '#e0e0e0';
                ctx.font = '16px Arial';
                ctx.fillText('Polar Plot: Œ± (angle) √ó |S(N,Œ±)| (radius)', centerX - 150, 30);
            }

            drawComplexPlane(data) {
                const canvas = document.getElementById('sumChart');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const padding = 80;
                const width = canvas.width - 2 * padding;
                const height = canvas.height - 2 * padding;
                const centerX = padding + width / 2;
                const centerY = padding + height / 2;
                
                // Draw complex plane axes
                ctx.strokeStyle = '#4ecdc4';
                ctx.lineWidth = 2;
                
                // Real axis
                ctx.beginPath();
                ctx.moveTo(padding, centerY);
                ctx.lineTo(canvas.width - padding, centerY);
                ctx.stroke();
                
                // Imaginary axis
                ctx.beginPath();
                ctx.moveTo(centerX, padding);
                ctx.lineTo(centerX, canvas.height - padding);
                ctx.stroke();
                
                const maxSum = Math.max(...data.map(r => r.sum));
                const scale = Math.min(width, height) / 4;
                
                // Plot complex exponential sums
                data.forEach(result => {
                    // Calculate complex sum components
                    let realPart = 0;
                    let imagPart = 0;
                    
                    // Simplified visualization - use alpha and sum to create complex coordinates
                    const angle = result.alpha * 2 * Math.PI;
                    const magnitude = result.sum / maxSum;
                    
                    realPart = magnitude * Math.cos(angle);
                    imagPart = magnitude * Math.sin(angle);
                    
                    const x = centerX + realPart * scale;
                    const y = centerY - imagPart * scale; // Flip Y for standard complex plane
                    
                    const ratio = result.sum / this.visualizationData.sqrtN;
                    ctx.fillStyle = ratio > 1.0 ? '#ff6b6b' : '#4ecdc4';
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                });
                
                // Labels
                ctx.fillStyle = '#e0e0e0';
                ctx.font = '16px Arial';
                ctx.fillText('Complex Plane Representation', centerX - 80, 30);
                ctx.fillText('Re', canvas.width - padding - 20, centerY + 20);
                ctx.fillText('Im', centerX + 10, padding + 20);
            }

            animateChart() {
                // Simple animation effect - could be expanded
                const canvas = document.getElementById('sumChart');
                const ctx = canvas.getContext('2d');
                
                // Add a subtle pulsing effect to high-ratio points
                let pulsePhase = 0;
                
                const animate = () => {
                    pulsePhase += 0.1;
                    if (pulsePhase < 2 * Math.PI) {
                        // Redraw with pulsing effect
                        const pulse = 1 + 0.2 * Math.sin(pulsePhase);
                        // This would require storing point positions and redrawing
                        requestAnimationFrame(animate);
                    }
                };
                
                animate();
            }

            populateFullDataTable() {
                this.updateTablePagination();
            }

            updateTablePagination() {
                const { results, sqrtN } = this.visualizationData;
                const pageSize = document.getElementById('tablePageSize').value;
                const tbody = document.getElementById('fullDataBody');
                tbody.innerHTML = '';
                
                let displayResults;
                if (pageSize === 'all') {
                    displayResults = results;
                    document.getElementById('paginationControls').style.display = 'none';
                } else {
                    const size = parseInt(pageSize);
                    const startIndex = (this.currentPage - 1) * size;
                    const endIndex = Math.min(startIndex + size, results.length);
                    displayResults = results.slice(startIndex, endIndex);
                    
                    // Update pagination controls
                    const totalPages = Math.ceil(results.length / size);
                    document.getElementById('pageInfo').textContent = `Page ${this.currentPage} of ${totalPages}`;
                    document.getElementById('paginationControls').style.display = totalPages > 1 ? 'block' : 'none';
                }
                
                document.getElementById('fullDataCount').textContent = `Showing ${displayResults.length} of ${results.length} total values`;
                
                displayResults.forEach((result, i) => {
                    const ratio = result.sum / sqrtN;
                    const originalRank = results.indexOf(result) + 1;
                    
                    let alphaType = 'Random';
                    if (this.isSimpleRational(result.alpha)) {
                        alphaType = 'Rational';
                    } else if (Math.abs(result.alpha - Math.round(result.alpha)) < 1e-10) {
                        alphaType = 'Integer';
                    } else if (result.alpha < 0.01 || result.alpha > 0.99) {
                        alphaType = 'Edge';
                    }
                    
                    const row = document.createElement('tr');
                    row.style.cssText = ratio > 1.0 ? 'background-color: rgba(255, 107, 107, 0.1);' : '';
                    if (ratio > 2.0) row.style.cssText += 'border-left: 3px solid #ff6b6b;';
                    
                    row.innerHTML = 
                        '<td style="padding: 10px 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); color: #e0e0e0;">' + originalRank + '</td>' +
                        '<td style="padding: 10px 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); color: #e0e0e0; font-family: monospace;">' + this.formatAlpha(result.alpha) + '</td>' +
                        '<td style="padding: 10px 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); color: #e0e0e0; font-family: monospace;">' + result.sum.toFixed(4) + '</td>' +
                        '<td style="padding: 10px 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); color: ' + (ratio > 1.0 ? '#ff6b6b' : '#4ecdc4') + '; font-family: monospace; font-weight: bold;">' + ratio.toFixed(4) + '</td>' +
                        '<td style="padding: 10px 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); color: #a0a0a0; font-size: 11px;">' + alphaType + '</td>' +
                        '<td style="padding: 10px 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.05);"><button onclick="highlightPoint(' + originalRank + ')" style="background: #667eea; border: none; padding: 4px 8px; border-radius: 3px; color: white; cursor: pointer; font-size: 10px;">üìç Locate</button></td>';
                    tbody.appendChild(row);
                });
            }
        }

        // Additional global functions for new features
        function saveVisualization() {
            const canvas = document.getElementById('sumChart');
            const link = document.createElement('a');
            link.download = 'riemann_hypothesis_visualization_' + new Date().toISOString().slice(0, 10) + '.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        function toggleFullscreen() {
            const canvas = document.getElementById('sumChart');
            if (canvas.requestFullscreen) {
                canvas.requestFullscreen();
            } else if (canvas.webkitRequestFullscreen) {
                canvas.webkitRequestFullscreen();
            }
        }

        function updateTablePagination() {
            if (tester.visualizationData) {
                tester.currentPage = 1;
                tester.updateTablePagination();
            }
        }

        function changePage(direction) {
            if (!tester.visualizationData) return;
            
            const pageSize = parseInt(document.getElementById('tablePageSize').value);
            if (pageSize === 'all') return;
            
            const totalPages = Math.ceil(tester.visualizationData.results.length / pageSize);
            tester.currentPage = Math.max(1, Math.min(totalPages, tester.currentPage + direction));
            tester.updateTablePagination();
        }

        function analyzePatterns(type) {
            if (!tester.visualizationData) return;
            
            const { results, sqrtN } = tester.visualizationData;
            const resultDiv = document.getElementById('patternResult');
            
            switch (type) {
                case 'peaks':
                    const peaks = results.filter(r => r.sum > sqrtN * 1.5);
                    resultDiv.textContent = `Found ${peaks.length} significant peaks (>1.5‚àöN)`;
                    break;
                case 'clusters':
                    const rationalClusters = results.filter(r => tester.isSimpleRational(r.alpha) && r.sum > sqrtN);
                    resultDiv.textContent = `Found ${rationalClusters.length} rational Œ± clusters above ‚àöN`;
                    break;
                case 'outliers':
                    const outliers = results.filter(r => (r.sum / sqrtN) > 3.0);
                    resultDiv.textContent = `Found ${outliers.length} statistical outliers (ratio > 3.0)`;
                    break;
            }
        }

        function highlightPoint(rank) {
            // This would highlight the specific point in the main chart
            alert('Point #' + rank + ' highlighted in visualization');
        }

        function generateReport() {
            if (!tester.visualizationData) return;
            
            const { results, maxN, sqrtN } = tester.visualizationData;
            const ratios = results.map(r => r.sum / sqrtN);
            
            let report = 'RIEMANN HYPOTHESIS COMPUTATIONAL VERIFICATION REPORT\n';
            report += '='.repeat(60) + '\n\n';
            report += `Test Date: ${new Date().toISOString().slice(0, 10)}\n`;
            report += `N Value: ${maxN.toLocaleString()}\n`;
            report += `‚àöN Bound: ${sqrtN.toFixed(4)}\n`;
            report += `Total Œ± Values Tested: ${results.length}\n\n`;
            
            report += 'STATISTICAL SUMMARY:\n';
            report += '-'.repeat(30) + '\n';
            report += `Maximum Ratio: ${Math.max(...ratios).toFixed(6)}\n`;
            report += `Average Ratio: ${(ratios.reduce((a,b) => a+b, 0) / ratios.length).toFixed(6)}\n`;
            report += `Values Above ‚àöN: ${results.filter(r => r.sum > sqrtN).length}\n`;
            report += `Rational Œ± Values: ${results.filter(r => tester.isSimpleRational(r.alpha)).length}\n`;
            report += `RH Violations (>3.0): ${results.filter(r => (r.sum / sqrtN) > 3.0).length}\n\n`;
            
            report += 'TOP 10 RESULTS:\n';
            report += '-'.repeat(30) + '\n';
            results.slice(0, 10).forEach((r, i) => {
                report += `${i+1}. Œ± = ${tester.formatAlpha(r.alpha)}, |S(N,Œ±)| = ${r.sum.toFixed(4)}, Ratio = ${(r.sum/sqrtN).toFixed(4)}\n`;
            });
            
            // Download as text file
            const blob = new Blob([report], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'riemann_hypothesis_report_N' + maxN + '_' + new Date().toISOString().slice(0, 10) + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
                const canvas = document.getElementById('sumChart');
                const ctx = canvas.getContext('2d');
                
                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const padding = 60;
                const width = canvas.width - 2 * padding;
                const height = canvas.height - 2 * padding;
                
                // Find max sum for scaling
                const maxSum = Math.max(...results.map(r => r.sum));
                const sqrtN = Math.sqrt(maxN);
                
                // Draw axes
                ctx.strokeStyle = '#4ecdc4';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(padding, padding);
                ctx.lineTo(padding, canvas.height - padding);
                ctx.lineTo(canvas.width - padding, canvas.height - padding);
                ctx.stroke();
                
                // Draw ‚àöN reference line
                const sqrtNY = canvas.height - padding - (sqrtN / maxSum) * height;
                ctx.strokeStyle = '#ff6b6b';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(padding, sqrtNY);
                ctx.lineTo(canvas.width - padding, sqrtNY);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // Label ‚àöN line
                ctx.fillStyle = '#ff6b6b';
                ctx.font = '12px Arial';
                ctx.fillText('‚àöN = ' + sqrtN.toFixed(1), canvas.width - padding - 80, sqrtNY - 5);
                
                // Draw data points
                ctx.fillStyle = '#4ecdc4';
                results.forEach((result, i) => {
                    const x = padding + (i / (results.length - 1)) * width;
                    const y = canvas.height - padding - (result.sum / maxSum) * height;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    // Highlight the maximum
                    if (i === 0) {
                        ctx.strokeStyle = '#ff6b6b';
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        ctx.arc(x, y, 8, 0, 2 * Math.PI);
                        ctx.stroke();
                    }
                });
                
                // Labels
                ctx.fillStyle = '#e0e0e0';
                ctx.font = '14px Arial';
                ctx.fillText('Œ± values (sorted by |S(N,Œ±)|)', canvas.width / 2 - 80, canvas.height - 20);
                
                ctx.save();
                ctx.translate(20, canvas.height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('|S(N,Œ±)|', -30, 0);
                ctx.restore();
                
                document.getElementById('visualization').style.display = 'block';
            }
        }

        // Initialize the application
        const tester = new RiemannHypothesisTester();

        // Preset functions
        function setPreset(value) {
            document.getElementById('customN').value = value;
            
            // Auto-optimize parameters for large N to prevent memory issues
            if (value >= 50000000) {
                document.getElementById('numSamples').value = '50';
                document.getElementById('maxDenom').value = '8';
            } else if (value >= 10000000) {
                document.getElementById('numSamples').value = '75';
                document.getElementById('maxDenom').value = '10';
            } else {
                document.getElementById('numSamples').value = '100';
                document.getElementById('maxDenom').value = '12';
            }
        }

        document.getElementById('startTest').addEventListener('click', async function() {
            if (tester.isComputing) return;
            
            tester.isComputing = true;
            const button = document.getElementById('startTest');
            button.disabled = true;
            button.textContent = 'Computing...';
            document.body.classList.add('computing');
            
            // Get N value from custom input
            const maxN = parseInt(document.getElementById('customN').value);
            const testMode = document.getElementById('testMode').value;
            const numSamples = parseInt(document.getElementById('numSamples').value);
            const maxDenom = parseInt(document.getElementById('maxDenom').value);
            
            // Validate input
            if (isNaN(maxN) || maxN < 1 || maxN > 100000000) {
                alert('Please enter a valid number between 1 and 100,000,000');
                tester.isComputing = false;
                button.disabled = false;
                button.textContent = 'üöÄ Launch Cosmic Test';
                document.body.classList.remove('computing');
                return;
            }
            
            try {
                const results = await tester.runVerification(maxN, testMode, numSamples, maxDenom);
                tester.displayResults(results);
            } catch (error) {
                console.error('Computation error:', error);
                alert('An error occurred during computation. Please try again with a smaller N value.');
            }
            
            tester.isComputing = false;
            button.disabled = false;
            button.textContent = 'üöÄ Launch Cosmic Test';
            document.body.classList.remove('computing');
        });

        // Add input validation and memory warnings
        document.getElementById('customN').addEventListener('input', function() {
            const value = parseInt(this.value);
            
            if (value > 100000000) {
                this.value = 100000000;
            } else if (value < 1) {
                this.value = 1;
            }
            
            // Show performance warning for large values
            const existingWarning = document.getElementById('performanceWarning');
            if (existingWarning) {
                existingWarning.remove();
            }
            
            if (value > 25000000) {
                const warning = document.createElement('div');
                warning.id = 'performanceWarning';
                warning.style.cssText = 'color: #ff6b6b; font-size: 12px; margin-top: 5px; padding: 8px; background: rgba(255, 107, 107, 0.1); border-radius: 4px; border-left: 3px solid #ff6b6b;';
                warning.innerHTML = '‚ö†Ô∏è Warning: N > 25 million may require significant memory and computation time. Parameters will be auto-optimized.';
                this.parentNode.appendChild(warning);
            }
        });
    </script>
</body>
    </html>
